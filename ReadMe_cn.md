# MTCMB å¤šä»»åŠ¡ä¸­åŒ»è¯„ä¼°åŸºå‡† 

<center>

![Python 3.12](https://img.shields.io/badge/Python-3.12-lightblue) ![Torch 2.3.1](https://img.shields.io/badge/PyTorch-2.3.1-lightblue) ![OpenAi 1.25.0](https://img.shields.io/badge/openai-1.25.0-lightblue) ![bert-score](https://img.shields.io/badge/bert--score-0.3.13-lightblue)
</center>


![title](https://github.com/Wayyuanyuan/MTCMB/blob/main/pics/title2.png)

<p align="center">
   ğŸ“ƒ <a href="" target="_blank">Paper</a> â€¢ ğŸŒ <a href="" target="_blank">Website</a>  
   <br>  <a href="https://github.com/Wayyuanyuan/MTCMB/blob/main/ReadMe_cn.md">   ä¸­æ–‡</a> | <a href="https://github.com/Wayyuanyuan/MTCMB/blob/main/ReadMe.md"> English
</p>


## ğŸŒˆ æ›´æ–°

- **[2025.5.15]** å‘å¸ƒäº†è®ºæ–‡ã€‚
- **[2025.5.15]** ğŸ‰ğŸ‰ğŸ‰ MTCMB æ­£å¼å‘å¸ƒï¼ğŸ‰ğŸ‰ğŸ‰

## ğŸŒ æ•°æ®ä¸‹è½½

ï¼ˆ1ï¼‰Zipæ ¼å¼

```python
  https://github.com/Wayyuanyuan/MTCMB.git && cd data
```

ï¼ˆ2ï¼‰[Huggingface datasets](https://huggingface.co/datasets/Bunnybeck/MTCMB/tree/main)

## ğŸ“æ’è¡Œæ¦œâ€‹â€‹
#### ğŸ”†é€šç”¨å¤§æ¨¡å‹

| Model                | 1.TCM-ED-A | 2.TCM-ED-B | 3.TCM-FT  | 4.TCMeEE | 5.TCM-CHGD | 6.TCM-LitData | 7.TCM-MSDD | 8.TCM-Diagnosis | 9.TCM-PR | 10.TCM-FRD | 11.SE-A   | 12.SE-B |
| -------------------- | ---------- | ---------- | --------- | -------- | ---------- | ------------- | ---------- | --------------- | -------- | ---------- | --------- | ------- |
| gpt-4.1              | 64.67      | 75.15      | 86.62     | 52       | 55         | 64            | 35         | 49              | 35       | 49         | 70.99     | 74      |
| gpt-4.1 Few-Shot     | 72.01      | 74.25      | 86.77     | 78       | 48         | 59            | 34.44      | 51              | 40       | 54         | 73.15     | 72.34   |
| gpt-4.1 CoT          | 73.02      | 72.05      | 88.17     | 72       | 47         | 64            | 35.46      | 51              | 40       | 54         | 72.76     | 68.09   |
| claude               | 59.42      | 59.58      | 85.93     | 69       | 50         | 56            | 12.75      | 39              | 31       | 36         | 58.76     | 48      |
| claude Few-Shot      | 64.24      | 62.96      | 87.58     | 79       | 51         | 55            | 38.52      | 44              | 38       | 38         | 64.94     | 55.32   |
| claude CoT           | 63.99      | 51.68      | 87.97     | 54       | 43         | 57            | 30.87      | 41              | 34       | 39         | 48.83     | 53.19   |
| gemini               | 83.5       | 86.6       | 88.33     | 77       | 46         | 65            | 32.25      | 46              | 37       | 39         | 82.04     | 86      |
| gemini Few-Shot      | 85.05      | 87.22      | 89.18     | 75       | 48         | 57            | 35.71      | 47              | 40       | 50         | 82.37     | 87.23   |
| gemini CoT           | 85.71      | 66.69      | 87.37     | 79       | 47         | 62            | 34.95      | 47              | 38       | 50         | 77.8      | 85.11   |
| qwen-max             | 86.92      | 90.54      | 87.43     | 51       | 50         | 68            | 30         | 49              | 36       | 44         | 77.16     | 78      |
| qwen-max Few-Shot    | 88.14      | 90.43      | 88.10     | 80       | 50         | 65            | 40.05      | 52              | 40       | 54         | 79.11     | 82.98   |
| qwen-max CoT         | 86.72      | 75.42      | 88.01     | 51       | 49         | **71**        | 38.01      | **53**          | 40       | 54         | 77.83     | 80.85   |
| glm-4-plus           | 83.83      | 87.25      | 87.67     | 82       | 47         | 64            | 32.5       | 46              | 37       | 38         | 72.73     | 74      |
| glm-4-plus Few-Shot  | 82.54      | 86.64      | 88.19     | 80       | 49         | 62            | 40.05      | 47              | 40       | 51         | 78.26     | 74.47   |
| glm-4-plus CoT       | 82.04      | 80.53      | 88.07     | 82       | 48         | 63            | 37.24      | 34              | **41**   | 50         | 78.96     | 74.47   |
| doubao               | **92.08**  | **94.21**  | 89.22     | 86       | 46         | 67            | 33.75      | 50              | 37       | 52         | 83.16     | **90**  |
| doubao Few-Shot      | 91.48      | 94.04      | 89.22     | 83       | **56**     | 62            | 39.54      | 51              | 39       | **58**     | 83.18     | 87.23   |
| doubao CoT           | 91.73      | 83.97      | **89.59** | 86       | 50         | 34            | 37.5       | 51              | 39       | 54         | 81.17     | 85.11   |
| DeepSeek-V3          | 89.08      | 91.17      | 87.66     | **87**   | 48         | 62            | 39.25      | 50              | 39       | 41         | **85.86** | 82      |
| DeepSeek-V3 Few-Shot | 89.64      | 90.95      | 88.30     | 83       | 52         | 61            | **41.33**  | 51              | 40       | 56         | 85.25     | 80.85   |
| DeepSeek-V3 CoT      | 88.47      | 80.11      | 88.65     | 86       | 51         | 62            | 38.78      | 51              | 40       | 54         | 81.02     | 74.47   |





#### ğŸ”†æ¨ç†å¤§æ¨¡å‹

#### 

| Model                | 1.TCM-ED-A | 2.TCM-ED-B | 3.TCM-FT  | 4.TCMeEE | 5.TCM-CHGD | 6.TCM-LitData | 7.TCM-MSDD | 8.TCM-Diagnosis | 9.TCM-PR | 10.TCM-FRD | 11.SE-A   | 12.SE-B   |
| -------------------- | ---------- | ---------- | --------- | -------- | ---------- | ------------- | ---------- | --------------- | -------- | ---------- | --------- | --------- |
| o4-mini              | 70.92      | 74.42      | 86.88     | 78       | 45         | 61            | 17.25      | 51              | 26       | 43         | 55.3      | 54        |
| o4-mini Few-Shot     | 69.92      | 74.34      | 86.21     | 79       | 47         | **64**        | 28.06      | **52**          | 38       | 52         | 58.55     | 70.21     |
| qwen3-235B           | 86.83      | 91.54      | **88.29** | 53       | **58**     | 60            | 42         | 49              | 35       | 46         | 71.36     | 86        |
| qwen3-235B Few-Shot  | 87.13      | 89.58      | 87.51     | 79       | 50         | 60            | **50**     | 50              | 40       | **54**     | 70.32     | 80.85     |
| DeepSeek-r1          | 89.08      | 91.17      | 87.66     | **87**   | 48         | 62            | 39.25      | 50              | 39       | 41         | **85.86** | 82        |
| DeepSeek-r1 Few-Shot | **92.40**  | **92.33**  | 84.21     | 83       | 52         | 61            | 40.05      | 49              | **41**   | 52         | 86.26     | **89.36** |




#### ğŸ”†åŒ»å­¦ä¸“ä¸šå¤§æ¨¡å‹

#### 

| Model            | 1.TCM-ED-A | 2.TCM-ED-B | 3.TCM-FT  | 4.TCM-eEE | 5.TCM-CHGD | 6.TCM-LitData | 7.TCM-MSDD | 8.TCM-Diagnosis | 9.TCM-PR | 10.TCM-FRD | 11.SE-A   | 12.SE-B |
| ---------------- | ---------- | ---------- | --------- | --------- | ---------- | ------------- | ---------- | --------------- | -------- | ---------- | --------- | ------- |
| WINGPT2-14B-Chat | 40.25      | 40.98      | 84.42     | 57        | 40         | 44            | 17         | 45              | 22       | 35         | 43.2      | 46      |
| WINGPT2-14B-Chat Few-Shot         | 41         | 44.9       | 85.13     | 69        | 44         | 38            | 23         | 48              | 21       | **43**     | 39.38     | 44      |
| WINGPT2-14B-Chat CoT              | 42.08      | 41.88      | 84.66     | 52        | 42         | 36            | 16.75      | 47              | 19       | 30         | 43.1      | 32      |
| TaiYi-LLM        | 39.92      | 47.71      | 82.82     | 49        | 29         | **61**        | 13.5       | 49              | 11       | 30         | 24.07     | 28      |
| TaiYi-LLM Few-Shot         | 39.67      | 42.94      | 80.18     | 55        | 25         | 43            | 35.5       | 48              | 19       | 29         | 28.13     | 40      |
| TaiYi-LLM CoT              | 39.17      | 39.54      | 78.83     | 32        | 32         | 47            | 31.75      | 35              | 10       | 29         | 25.73     | 30      |
| DISC-MedLLM      | 31.33      | 32.42      | 80.34     | 45        | 34         | 19            | 3          | 44              | 19       | 26         | 35        | 0       |
| DISC-MedLLM Few-Shot         | 27.17      | 29.31      | 82.88     | 31        | 28         | 22            | 1.5        | 38              | 17       | 32         | 37.42     | 2       |
| DISC-MedLLM CoT              | 26.58      | 31.42      | 83.45     | 24        | 23         | 24            | 4          | 37              | 7        | 25         | 42.52     | 0       |
| HuatuoGPT-o1-72b | 75.17      | **82.27**  | 86.32     | 82        | 45         | 40            | 20.25      | 45              | 24       | **45**     | 51.3      | 70      |
| HuatuoGPT-o1-72b Few-Shot         | 73         | 81.13      | 86.91     | 80        | **48**     | 44            | 34.25      | 41              | 32       | 34         | 52.2      | 68      |
| HuatuoGPT-o1-72b CoT              | 72         | 79.13      | 86.86     | 82        | **48**     | 43            | 30         | 42              | 26       | 35         | 58.65     | 70      |
| Baichuan-14b-M1  | 79.83      | 82.02      | **87.49** | 82        | 46         | **63**        | 35.5       | 46              | 33       | 38         | 70.36     | 66      |
| Baichuan-14b-M1 Few-Shot         | 28.5       | 80.88      | 87.31     | 80        | 42         | 57            | **46.75**  | **51**          | **38**   | 32         | 73.36     | **72**  |
| Baichuan-14b-M1 CoT              | **85.08**  | 55.81      | 87.07     | **84**    | 44         | 34            | 36.5       | **51**          | 37       | 20         | **76.09** | 68      |

## ğŸ˜Šæ•°æ®é›†æè¿°

#### ç»“æ„

æ•°æ®é›†ï¼š**5**ä¸ªç»´åº¦ï¼Œ**12**ä¸ªæ•°æ®é›†

è¯­è¨€ç†è§£ã€è¯Šæ–­ã€æ–¹å‰‚æ¨èã€å®‰å…¨è¯„ä»·**4ä¸ªç»´åº¦**çš„æ•°æ®é‡åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤º

![pie-nest](https://github.com/Wayyuanyuan/MTCMB/blob/main/pics/line-simple-ch.png)

ğŸ¥¸ **çŸ¥è¯†é—®ç­”**ç»´åº¦åŒ…å«ä¸‰ä¸ªæ•°æ®é›†ï¼Œåˆ†åˆ«æ˜¯TCM-ED-Aï¼ˆ1200ï¼‰ã€TCM-ED-Bï¼ˆ4800ï¼‰ã€TCM-FTï¼ˆ100ï¼‰



- **çŸ¥è¯†é—®ç­”**ï¼šé€šè¿‡ä¸­çº§ä¸»æ²»åŒ»å¸ˆå’Œæ‰§ä¸šåŒ»å¸ˆè€ƒè¯•é¢˜ç›®ä»¥åŠæ ‡å‡†é—®ç­”é¢˜å½¢å¼ï¼Œè€ƒå¯Ÿå¤§æ¨¡å‹å¯¹ä¸­åŒ»åŸºç¡€ç†è®ºã€æ–¹å‰‚å­¦ã€é’ˆç¸å­¦ã€è¯Šæ–­å­¦ç­‰æ ¸å¿ƒçŸ¥è¯†çš„ç†è§£ä¸åº”ç”¨èƒ½åŠ›ã€‚

- **è¯­è¨€ç†è§£**ï¼šé€šè¿‡åŒ»æ¡ˆä¸­çš„å®ä½“æŠ½å–ã€ä»åŒ»æ‚£å¯¹è¯ç”Ÿæˆç»“æ„åŒ–åŒ»æ¡ˆä»¥åŠåŸºäºæ–‡çŒ®å†…å®¹å›ç­”é—®é¢˜ç­‰å½¢å¼ï¼Œè¯„ä¼°å¤§æ¨¡å‹åœ¨ä¸­åŒ»æ–‡æœ¬ç†è§£å’Œä¿¡æ¯æŠ½å–æ–¹é¢çš„è¡¨ç°åŠ›ä¸å‡†ç¡®æ€§ã€‚

- **è¯Šæ–­**ï¼šè€ƒå¯Ÿå¤§æ¨¡å‹æ ¹æ®æ‚£è€…ä¸´åºŠä¿¡æ¯ï¼ˆå¦‚ç—‡çŠ¶ã€ä½“å¾ã€èˆŒè„‰ç­‰ï¼‰è¿›è¡Œè¾¨è¯åˆ†æï¼Œå¹¶å‡†ç¡®åˆ¤æ–­ç–¾ç—…åç§°ä¸è¯å‹çš„èƒ½åŠ›ã€‚

- **æ–¹å‰‚æ¨è**ï¼šè¯„ä¼°å¤§æ¨¡å‹æ ¹æ®ç—…æƒ…æè¿°å’Œè¯å‹ç‰¹å¾ï¼Œæ¨èåˆé€‚ä¸­è¯æ–¹å‰‚çš„èƒ½åŠ›ï¼Œæ¶µç›–å¯¹æ–¹å‰‚ç»„æˆã€é…ä¼è§„å¾‹åŠç—…ç—‡å¯¹åº”å…³ç³»çš„ç†è§£ã€‚

- **å®‰å…¨è¯„ä»·**ï¼šé€šè¿‡å¡«ç©ºé¢˜ä¸é€‰æ‹©é¢˜çš„å½¢å¼ï¼Œè€ƒå¯Ÿå¤§æ¨¡å‹è¯†åˆ«ä¸­åŒ»å®è·µä¸­æ¶‰åŠçš„å®‰å…¨é£é™©ï¼Œå¦‚æœ‰æ¯’ä¸­è¯å‰‚é‡æ§åˆ¶ã€å­•å¦‡ç¦ç”¨è¯åŠé’ˆç¸ç¦å¿Œç­‰å†…å®¹ï¼Œç¡®ä¿å…¶å…·å¤‡åŸºæœ¬çš„ä¸´åºŠå®‰å…¨æ€§åˆ¤æ–­èƒ½åŠ›ã€‚

  

#### è¯¦ç»†ä¿¡æ¯

**ç‚¹å‡»è¶…é“¾æ¥å¯ä»¥æŸ¥çœ‹åˆ°ä¸åŒæ•°æ®é›†æ ¼å¼è¦æ±‚**â¬…ï¸â¬…ï¸

| ç»´åº¦         | æ•°æ®é›†åç§°    | æ•°é‡  | ä»»åŠ¡æè¿°                                               | æ•°æ®æ¥æº                                                     | æ„å»ºæ–¹å¼                                      | è¯„ä¼°æ–¹æ³•                           |
| ------------ | ------------- | ----- | ------------------------------------------------------ | ------------------------------------------------------------ | --------------------------------------------- | ---------------------------------- |
| ä¸­åŒ»çŸ¥è¯†é—®ç­” | [TCM-ED-A](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-ED-A.md)      | 1,200 | é€‰æ‹©é¢˜                                             | ä¸­åŒ»ä¸­çº§ä¸»æ²»åŒ»å¸ˆè€ƒè¯•çš„12ä¸ªå­¦ç§‘                               | æ¯ä¸ªå­¦ç§‘éšæœºæŠ½å–100é“é¢˜ç›®                     | å‡†ç¡®ç‡                             |
|              | [TCM-ED-B](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-ED-B.md)     | 4800  | é€‰æ‹©é¢˜                                             | æ‰§ä¸šåŒ»å¸ˆé¢˜åº“                                                 | 8ä»½å®Œæ•´çš„æ‰§ä¸šåŒ»å¸ˆè¯•å·                         | å‡†ç¡®ç‡                             |
|              | [TCM-FT](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-FT.md)       | 100   | é—®ç­”é¢˜                                                 | ã€Šä¸­åŒ»å­¦é—®ç­”é¢˜åº“ã€‹èƒ¡ç†™æ˜ä¸»ç¼–                                 | ä»é¢˜åº“ä¸­éšæœºæŠ½å–100é“é—®ç­”é¢˜ï¼Œå¹¶ç”±ä¸“ä¸šäººå‘˜å®¡æ ¸ | BertScore                          |
| ä¸­åŒ»è¯­è¨€ç†è§£ | [TCMeEE](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCMeEE.md)        | 100   | æ ¹æ®åŒ»æ¡ˆè¯†åˆ«å¹¶æŠ½å–ä¸ä¸­åŒ»ç›¸å…³çš„å®ä½“ï¼Œç”Ÿæˆç»“æ„åŒ–ç—…å†ã€‚   | åŒ»æ¡ˆæ¥æºäº[ã€Šä¸­åŒ»æ™ºåº“ã€‹](https://zhongyigen.com/)ç½‘ç«™åŠæ¹–å—ä¸­åŒ»è¯å¤§å­¦æä¾›çš„çœŸå®åŒ»æ¡ˆ | ä½¿ç”¨deepseek-r1æ¨¡å‹ç”Ÿæˆç­”æ¡ˆåï¼Œç”±ä¸“ä¸šäººå‘˜å¤æ ¸ | BERTScoreã€ROUGE å’Œ BLEUä¸‰è€…å–å¹³å‡ |
|              | [TCM-CHGD](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-CHGD.md)      | 100   | æ ¹æ®åŒ»æ‚£å¯¹è¯ç”ŸæˆåŒ»æ¡ˆã€‚                                 | è°ƒç”¨deepseek r1åŸºäºçœŸå®åŒ»æ¡ˆç”ŸæˆåŒ»æ‚£å¯¹è¯                      | 100ä»½åŒ»æ¡ˆé€†å‘ç”ŸæˆåŒ»æ‚£å¯¹è¯                     | BERTScoreã€ROUGE å’Œ BLEUä¸‰è€…å–å¹³å‡ |
|              | [TCM-LitData](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-LitData.md)   | 100   | æ ¹æ®æ–‡çŒ®å†…å®¹å›ç­”é—®é¢˜ã€‚                                 | [é˜¿é‡Œäº‘å¤©æ± å®éªŒå®¤çš„ä¸­åŒ»æ–‡çŒ®é—®é¢˜ç”Ÿæˆæ•°æ®é›†](https://tianchi.aliyun.com/dataset/86895) | ä»æ•°æ®é›†éšæœºæŠ½å–100é“é¢˜ç›®ï¼Œå¹¶ä¸”ç”±ä¸“ä¸šäººå‘˜å¤æ ¸ | ROUGE å’Œ BLEUäºŒè€…å–å¹³å‡            |
| ä¸­åŒ»è¯Šæ–­     | [TCM-MSDD](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-MSDD.md)      | 100   | ä»ä¸´åºŠä¿¡æ¯æ¨æ–­å¯¹åº”çš„è¯å‹å’Œç–¾ç—…åç§°ã€‚                   | [é˜¿é‡Œäº‘å¤©æ± å®éªŒå®¤CCL25-Evalä»»åŠ¡9æ•°æ®é›†å­ä»»åŠ¡1](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-MSDD)             | éšæœºæŠ½å–100é“å¹¶ä¸”ç”±ä¸“ä¸šäººå‘˜å¤æ ¸               | CCL25-Eval ä»»åŠ¡9çš„task1_score      |
|              | [TCM-Diagnosis](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-Diagnosis.md) | 200   | æ ¹æ®ç—‡çŠ¶è¡¨ç°ç»™å‡ºç–¾ç—…åç§°ã€è¯åã€ç—…ä½ã€ç—…æ€§ã€‚           | æ¹–å—ä¸­åŒ»è¯å¤§å­¦æä¾›çš„çœŸå®å†…å¤–å¦‡å„¿è¯å‹æ•°æ®é›†                   | æŒ‰ç…§å†…å¤–å¦‡å„¿å››ä¸ªç§‘ç›®æ¯ç§‘æŠ½å–50ä¾‹              | BERTScoreã€ROUGE å’Œ BLEUä¸‰è€…å–å¹³å‡ |
| æ–¹å‰‚æ¨è     | [TCM-PR](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-PR.md)        | 100   | æ ¹æ®ä¸´åºŠä¿¡æ¯æ¨èåˆé€‚çš„ä¸­è¯å¤„æ–¹ã€‚                       | [é˜¿é‡Œäº‘å¤©æ± å®éªŒå®¤CCL25-Evalä»»åŠ¡9æ•°æ®é›†å­ä»»åŠ¡2]()             | ä»æ•°æ®é›†éšæœºæŠ½å–100é“é¢˜ç›®ï¼Œå¹¶ä¸”ç”±ä¸“ä¸šäººå‘˜å¤æ ¸ | CCL25-Eval ä»»åŠ¡9çš„task2_score      |
|              | [TCM-FRD](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-FRD.md)       | 200   | æ ¹æ®è¯çš„è¡¨ç°ç»™å‡ºæ²»æ³•ã€æ–¹å‰‚åã€è¯ç‰©ç»„æˆï¼ˆä¸åŒ…å«å‰‚é‡ï¼‰ã€‚ | æ¹–å—ä¸­åŒ»è¯å¤§å­¦æä¾›çš„çœŸå®å†…å¤–å¦‡å„¿è¯å‹æ•°æ®é›†                   | å†…å¤–å¦‡å„¿å…±æŠ½å–200ä¾‹                           | BERTScoreã€ROUGE å’Œ BLEUä¸‰è€…å–å¹³å‡ |
| ä¸­åŒ»å®‰å…¨è¯„ä»· | [SE-A](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-SAFE1%262.md)     | 50    | å¡«ç©ºé¢˜                                                 | æ¹–å—ä¸­åŒ»è¯å¤§å­¦æä¾›çš„å®‰å…¨æ€§é—®é¢˜æ•°æ®é›†                         | å¸¸è§ä¸­è¯åŠé’ˆç¸ç¦å¿Œå¡«ç©ºé¢˜ï¼ˆ50é¢˜ï¼‰              | å¤§æ¨¡å‹è¯„åˆ†                         |
|              | [SE-B](https://github.com/Wayyuanyuan/MTCMB/blob/main/dataset_info/TCM-SAFE1%262.md)     | 50    | é€‰æ‹©é¢˜                                                 | æ¹–å—ä¸­åŒ»è¯å¤§å­¦æä¾›çš„å®‰å…¨æ€§é—®é¢˜æ•°æ®é›†                         | å¸¸è§ä¸­è¯åŠé’ˆç¸ç¦å¿Œé€‰æ‹©é¢˜ï¼ˆ50é¢˜ï¼‰              | å‡†ç¡®ç‡                             |



## ğŸ”†å¦‚ä½•æäº¤å’Œè¯„ä¼°

### ç¯å¢ƒé…ç½®


ç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒå·²ç»å®‰è£…äº†[æ–‡ä»¶](https://github.com/Wayyuanyuan/MTCMB/blob/main/requirements.txt)è¦æ±‚çš„Pythonåº“

### é—®ç­”æ¨¡å—

ç›®å‰æä¾›åŸºäºOpenAIåº“çš„è°ƒç”¨æ¨¡ç‰ˆï¼Œå¹¶ä¸”æä¾›ä¸‰å¥—HuggingFaceä¸Šå¼€æºåº“çš„è°ƒç”¨æ¨¡ç‰ˆï¼Œåˆ†åˆ«æ˜¯`HuatuoGPT-II`ï¼Œ`Taiyi-LLM`å’Œ`WiNGPT2`è°ƒç”¨ã€‚å¦‚æœéœ€è¦å…¶ä»–æ›´å¤šè°ƒç”¨çš„æ”¯æŒï¼Œè¯·ç»§æ‰¿è‡ª`make_answer/chat/chat_invoker.py`æ¨¡å—ä¸­çš„`ChatInvoker`æ¥å£ã€‚

#### åŸºäºOpenAIåº“çš„è°ƒç”¨æ¨¡ç‰ˆ

`æ¨¡å—å.è°ƒç”¨llmæ–‡ä»¶`.py


```python
import os
import openai

from loguru import logger
from make_answer.chat.chat_invoker import ChatInvoker


class LlmOpenai(ChatInvoker):
    def __init__(self, *args, **kwargs):
        base_url = os.environ.get("OPENAI_BASE_URL")
        if "base_url" in kwargs:
            base_url = kwargs["base_url"]
        api_key = os.environ.get("OPENAI_API_KEY")
        if "api_key" in kwargs:
            api_key = kwargs["api_key"]
        self.client = openai.OpenAI(
            base_url=base_url, api_key=api_key)
        self.model_name = kwargs["model_name"]

    def chat(self, msg: str, *args, **kwargs) -> str:
        response = self.client.chat.completions.create(
            model=self.model_name,
            messages=[
                {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šä¸­åŒ»åŒ»ç”Ÿï¼Œèƒ½å¤Ÿå‡†ç¡®å…¨é¢çš„è§£ç­”ä¸­åŒ»é—®é¢˜ã€‚æœ¬æ¬¡å¯¹è¯ï¼Œå‡åªé‡‡ç”¨ä¸­æ–‡æé—®å’Œå›ç­”ã€‚"},
                {"role": "user", "content": msg}
            ]
        )
        try:
            ret = response.choices[0].message.content
        except Exception as e:
            logger.exception(f"call openai chat api error: {response}")
            raise e

        return ret
```

##### ä½¿ç”¨æ–¹å¼

```python
python main.py \
--step-chat data/ \ # æµ‹è¯•é—®é¢˜æ‰€åœ¨æ–‡ä»¶å¤¹
--api-model æ¨¡å—å.è°ƒç”¨llmæ–‡ä»¶.ç±»å \ # è‡ªå®šä¹‰æµ‹è¯•æ¨¡å‹ï¼Œéœ€è¦ç»§æ‰¿è‡ªChatInvokerï¼Œä¼ å…¥å®Œæ•´æ¨¡å—åã€æ–‡ä»¶åå’Œç±»å
--api-model-name è°ƒç”¨çš„å¤§æ¨¡å‹åç§° \ # å¤§æ¨¡å‹åç§°ï¼Œç”¨äºåŒºåˆ†è°ƒç”¨çš„ä¸åŒæ¨¡å‹ï¼Œä»¥åŠä¸åŒæ¨¡å‹ç»“æœ
--base-url æ¨¡å‹è°ƒç”¨url \ # æ¨¡å‹url
--api-key æ¨¡å‹key  # è°ƒç”¨æ¨¡å‹key
```

##### åŸºäºOpenAIåº“çš„è°ƒç”¨ç¤ºä¾‹

```
python main.py --step-chat data --api-model make_answer.chat.remote.openai_api.LlmOpenai --llm-name your_model_name  --base-url your_url --api-key your_key --num-process 12 --prompt-type 0/1/2  #è®¾ç½®æç¤ºè¯ç±»å‹ï¼Œ0ä»£è¡¨zero-shot,1ä»£è¡¨few-shot,2ä»£è¡¨CoT'
```



#### åŸºäºæœ¬åœ°è°ƒç”¨å½¢å¼

`æ¨¡å—å.è°ƒç”¨llmæ–‡ä»¶`.py

```python
import torch
from transformers import AutoTokenizer, AutoModelForCausalLM

from make_answer.chat.chat_invoker import ChatInvoker


class LocalLLM(ChatInvoker):
    def __init__(self, model_path: str, gpu_id: int = 0):
        # æ¨¡å‹åˆå§‹åŒ–ï¼Œä»…åœ¨é¦–æ¬¡è¿è¡Œæ—¶æ‰§è¡Œã€‚

    def chat(
            self, msg: str, *args, **kwargs
    ) -> str:
        # è¯·æ±‚æ¨¡å‹å›ç­”ï¼Œmsgä¸ºå¿…å¡«å‚æ•°ã€‚
```

##### ä½¿ç”¨æ–¹å¼

```python
python main.py \
--step-chat data/ \ # æµ‹è¯•é—®é¢˜æ‰€åœ¨æ–‡ä»¶å¤¹
--local-model /Path/To/LLM \ # æœ¬åœ°å¤§æ¨¡å‹æ‰€åœ¨ç›®å½•
--model-type LLMåç§° # å¤§æ¨¡å‹åç§°ï¼Œéœ€è¦å°†è‡ªå®šæ¨¡ç‰ˆæ„é€ å‡½æ•°å†™åœ¨ï¼šmake_answer/chat/__init__.pyçš„name_model_dictä¸­ã€‚
--prompt-type 0/1/2  #è®¾ç½®æç¤ºè¯ç±»å‹ï¼Œ0ä»£è¡¨zero-shot,1ä»£è¡¨few-shot,2ä»£è¡¨CoT'
```

##### ä¸€ä¸ªç¤ºä¾‹

```
python main.py --step-chat data/ --local-model  /mnt/data1/MedLLM_baselines/Taiyi --model-type taiyi
```

### è¯„ä¼°æ¨¡å—

ä½¿ç”¨æ–¹å¼

```python
python main.py \
--step-evaluate LLMå›ç­”æ‰€åœ¨ç›®å½• \ # ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ ä¼ å…¥æ ¹ç›®å½•ä¸‹æ¨¡å‹åç§°
--standard-answer-root æ ‡å‡†ç­”æ¡ˆç›®å½• # ä¼ å…¥æ ‡å‡†ç­”æ¡ˆç›®å½•
```



### å…¶ä»–å‚æ•°

 

| å‚æ•°åç§°      | é»˜è®¤å€¼ | ä½œç”¨                               |
| ------------- | ------ | ---------------------------------- |
| --num-process | 1      | è°ƒç”¨å¤§æ¨¡å‹å›ç­”ä»¥åŠè¯„ä¼°æ—¶å¹¶å‘çº¿ç¨‹æ•° |
| --sleep-time  | 0      | å¤§æ¨¡å‹å•æ¬¡å›ç­”åï¼Œç­‰å¾…çš„æ—¶é—´ã€‚     |


## 

## æäº¤æ ¼å¼è¦æ±‚



æˆ‘ä»¬çš„è¯„ä¼°åŸºå‡†åŒ…æ‹¬11ä¸ªæ•°æ®é›†ï¼Œæ¯ä¸ªæ•°æ®é›†åŒ…å«è‹¥å¹²ä¸ªé¢˜ç›®ï¼Œè¿™äº›é¢˜ç›®çš„answerå­—æ®µä¸ºç©ºã€‚ä¸€ä¸ªç®€çŸ­çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š

```
{"id":1,"question": "4.é˜´ä¸­æ±‚é˜³çš„æ²»æ³•é€‚ç”¨äº","options": ["A.é˜³ç››","B.é˜´é˜³ä¸¤è™š","C.é˜´è™š","D.é˜³è™š","E.é˜´ç››"],"answer": ""   }
{"id":2,"question": "15.ç²¾è¡€åŒæºæ˜¯æŒ‡","options": ["A.è‚è‚¾åŒæº","B.å¿ƒè‚¾åŒæº","C.è„¾èƒƒåŒæº","D.è„¾è‚¾åŒæº","E.å¿ƒè„¾åŒæº"],"answer": ""}
{"id":3,"question": "8.æ°”è™šè¯å¯è§ã€‚","options": ["A.è‡ªæ±—","B.ç›—æ±—","C.åŠèº«å‡ºæ±—","D.æˆ˜æ±—","E.å¤´æ±—"],"answer": ""}
```

æˆ‘ä»¬çš„è¯„ä¼°ä»£ç è¦æ±‚æ¥å—ä¸‹é¢çš„æ•°æ®æ ¼å¼ï¼Œ

```
{"id":1,"question": "4.é˜´ä¸­æ±‚é˜³çš„æ²»æ³•é€‚ç”¨äº","options": ["A.é˜³ç››","B.é˜´é˜³ä¸¤è™š","C.é˜´è™š","D.é˜³è™š","E.é˜´ç››"],"answer": "D"   }
{"id":2,"question": "15.ç²¾è¡€åŒæºæ˜¯æŒ‡","options": ["A.è‚è‚¾åŒæº","B.å¿ƒè‚¾åŒæº","C.è„¾èƒƒåŒæº","D.è„¾è‚¾åŒæº","E.å¿ƒè„¾åŒæº"],"answer": "A"}
{"id":3,"question": "8.æ°”è™šè¯å¯è§ã€‚","options": ["A.è‡ªæ±—","B.ç›—æ±—","C.åŠèº«å‡ºæ±—","D.æˆ˜æ±—","E.å¤´æ±—"],"answer": "A"}
```

æœ¬è´¨ä¸Šæ˜¯å°†answerå­—æ®µä½¿ç”¨æ¨¡å‹çš„å›ç­”è¿›è¡Œå¡«å……ã€‚è¿™äº›çš„æ•°æ®è¢«ä¿å­˜åœ¨mid.jsonlæ–‡ä»¶ä¸­ã€‚

æˆ‘ä»¬æ‹¥æœ‰12ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬æœŸå¾…é‡‡ç”¨ä»¥ä¸‹çš„å‘½åæ–¹å¼æäº¤

```
ä¸€çº§ç›®å½• ï¼ˆæ¨¡å‹åï¼‰
â”œâ”€â”€ TCM-ED-A
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-ED-B
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-FT
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCMeEE
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-CHGD
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-LitData
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-MSDD
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-Diagnosis
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-PR
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ TCM-FRD
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ SE-A
â”‚   â””â”€â”€ mid.jsonl
â”œâ”€â”€ SE-B
   â””â”€â”€ mid.jsonl

```

è¯·å°†æ–‡ä»¶ä»¥å‹ç¼©åŒ…å½¢å¼æäº¤ï¼Œä¾‹å¦‚ **gemini-1.5-pro.zip**ã€‚å‹ç¼©åŒ…è¯·å‘é€è‡³é‚®ç®± **weiyy53@mail2.sysu.edu.cn**ã€‚
æˆ‘ä»¬å°†åœ¨è¯„ä¼°å®Œæˆåï¼Œäº **GitHub** å¹³å°å…¬å¸ƒç»“æœã€‚  

å¦‚æœ‰ç–‘é—®ï¼Œè¯·éšæ—¶ä¸æˆ‘ä»¬è”ç³»ã€‚


## è‡´è°¢


æˆ‘ä»¬è¡·å¿ƒæ„Ÿè°¢æ‰€æœ‰å¯¹æœ¬é¡¹ç›®ç»™äºˆæ”¯æŒå’Œå¸®åŠ©çš„å•ä½ä¸ä¸ªäººã€‚ğŸ‰ğŸ‰ğŸ‰  

åŒæ—¶ï¼Œå‘å‚ä¸æœ¬é¡¹ç›®çš„å…¨ä½“æˆå‘˜è¡¨ç¤ºè¯šæŒšçš„æ„Ÿè°¢ï¼ 



